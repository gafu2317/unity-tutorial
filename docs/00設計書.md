# 魔法創造ダンジョン探索ゲーム 設計書


## タイトル

「SpellCraft Dungeon」
〜 Create Your Magic, Conquer the Depths 〜

「魔法工房」
〜 君だけの魔法で挑む無限迷宮 〜

## 1. ゲーム概要

### コンセプト
プレイヤーが独自の魔法を作成し、無限に続くランダム生成ダンジョンを探索するトップダウン2Dアクションゲーム
できるだけリアルな仕様を入れている
(例)
* 同じ敵からの経験値がだんだん減る
* 無限大の魔法
* すぐに使える魔法は少数(あまり使っていないものはすぐ使えないのをスクロールしないといけないことで表現)
* 魔法をたくさん使うと練度が上がる(レベルが高いと上がりやす、練度による威力向上、消費魔力低下はだんだん効果が薄くなる)
* 魔法の複雑さによって消費魔力が増える

### ターゲット
- 初心者向けの実装難易度
- 深いカスタマイズ要素を求めるプレイヤー
- 無限の探索とビルド実験を楽しみたいプレイヤー

## 2. ゲームシステム

### 2.1 基本ゲームプレイ
- **視点**: トップダウン（上から見下ろし）
- **操作**: WASD移動、マウスでエイム・魔法発動
- **進行**: 無限階層のダンジョン探索
- **目標**: より深い階層への到達、より強力な魔法の習得

### 2.2 ダンジョンシステム
- **生成**: 各フロアはランダム生成
- **構造**: 複数の部屋が通路で繋がった迷路型
- **進行**: 各フロアの出口を見つけて次のフロアへ
- **難易度**: フロアが深くなるほど敵が強く、新要素が必要

## 3. 魔法システム

### 3.1 魔法の構成要素

#### 属性 (Element)
- **火属性**: 燃焼ダメージ、氷を溶かす
- **水属性**: 冷却、火を消す、植物を成長させる
- **風属性**: 移動力向上、軽いオブジェクトを吹き飛ばす
- **土属性**: 防御力向上、障壁作成

#### 形状 (Shape)
- **球**: 直進する投射物
- **槍**: 高速で貫通する直線攻撃
- **壁**: 一定時間持続する障壁
- **爆発**: 範囲攻撃
- **連鎖**: 複数の対象に伝播

#### 効果 (Effect)
- **ダメージ**: 敵にダメージを与える
- **回復**: HPを回復する
- **移動**: プレイヤーや対象を移動させる
- **状態異常**: 毒、麻痺、混乱など
- **バフ/デバフ**: 能力値の一時的変更

### 3.2 魔法作成システム

#### 作成方法
1. **ドラッグ&ドロップ**でUI上で要素を組み合わせ
2. **プレビュー機能**で効果を事前確認
3. **名前付け**で魔法を管理
4. **お気に入り登録**で素早くアクセス

#### 作成タイミング
- **戦闘前**: 時間をかけてじっくり作成・調整
- **戦闘中**: リアルタイム作成（時間は止まらない、高難易度）

#### 複雑度計算(例)
```
基本消費MP = (属性数 × 2) + (形状複雑度 × 3) + (効果数 × 4)
```

### 3.3 魔法管理システム

#### 保存・整理
- **無制限保存**: 作成した魔法はすべて保存可能
- **クイックスロット**: 8個の魔法を素早く使用可能
- **カテゴリ分け**: 攻撃、防御、補助等で自動分類
- **検索機能**: 名前や効果で魔法を検索

#### 魔法スロット
- **アクティブスロット**: 8個（数字キー1-8で発動）
- **スクロール機能**: マウスホイールで他の魔法にアクセス
- **ホットスワップ**: 戦闘中でもスロット入れ替え可能

## 4. 成長システム

### 4.1 プレイヤーレベル
- **経験値獲得**: 敵を倒すと取得（同種の敵は逓減）
- **レベルアップ効果**:
  - 最大MP増加
  - 練度上昇率向上
  - 新しい魔法要素習得の可能性

### 4.2 魔法練度システム

#### 練度の仕組み
- **個別練度**: 魔法ごとに独立した熟練度
- **上昇条件**: その魔法を使用するたびに経験値獲得
- **成長曲線**: 対数関数的（最初は急激、後半は緩やか）

#### 練度による効果(例)
```
威力 = 基本威力 × (1 + log(練度+1) × 0.3)
消費MP = 基本消費 × (1 - log(練度+1) × 0.1)
```

### 4.3 装備システム

#### 装備品カテゴリ
- **杖**: 魔法威力向上、MP回復速度上昇
- **ブローチ**: 最大MP増加、特定属性強化
- **指輪**: 練度上昇率向上、状態異常耐性
- **ローブ**: 防御力、魔法詠唱時間短縮

#### 装備効果例
- 火炎強化の杖: 火属性魔法の威力+20%
- 知恵のブローチ: 最大MP+30、練度上昇率+15%

#### **装備システム：魔法技術の物理的・身体的考察**

ここでの装備品は、単に能力を数値的に増減させるゲーム的アイテムではなく、魔法という現象を制御し、術者の負担を軽減し、その効果をより高度に引き出すための「**専門的な道具（ツール）**」として定義する。魔法が現実の物理法則や身体機能の延長線上に存在するという仮説に基づき、各装備の役割を以下のように考察する。

***

#### **杖：魔法の増幅器および指向性アンテナ**

杖は、術者が体内で生成した魔力エネルギーを外部へ放射する際の媒体であり、その効率と精度を飛躍的に高めるツールである。

* **指向性の強化と収束（レンズ効果）**
    術者から放たれる拡散しがちな魔力エネルギーを、レンズが光を収束させるように一方向へまとめ上げる。これにより、同じ総エネルギー量でも単位面積あたりの密度が格段に上がり、結果として**魔法威力が向上**（貫通力・破壊力が増大）する。

* **共振による増幅（アンプ効果）**
    杖の芯に使われる素材（例：魔獣の骨、古代樹の枝）が、特定の周波数を持つ魔力（属性）と共振する。術者がわずかな魔力を流すだけで杖全体が増幅装置として機能し、少ない精神的・身体的負担でより強力な魔法を行使できる。これも**魔法威力向上**の主要因である。
    * **装備効果例**: 《火炎強化の杖》は、芯材が火の属性魔力と特に強く共振する性質を持ち、結果として**火属性魔法の威力を+20%**する。

* **安定化と術式補助（スタビライザー効果）**
    複雑な術式は本質的に不安定だが、杖が触媒や安定器として機能することで、術式構造の暴発や失敗リスクを劇的に低減させる。

* **エネルギー効率の改善**
    上記の機能により、魔法行使におけるエネルギーロスが最小限に抑えられる。これにより術者の消耗が減り、結果的に**MP回復速度の上昇**という形で効果が実感される。

***

#### **ブローチ：術者の内的制御装置**

身体に直接、あるいは近接して装着するブローチやアミュレットは、術者自身の内的な魔力循環や精神状態に作用する。

* **魔力循環の円滑化**
    術者の体内に張り巡らされた魔力の通り道（経絡のようなもの）に働きかけ、その流れをスムーズにする。これにより、一度に扱える魔力量の限界、すなわち**最大MPが増加**する。

* **魔力フィルターと属性親和**
    体内に取り込む自然魔力（マナ）から不純物を除去し、魔法の安定性を高める。また、特定の宝石や金属は、特定属性の魔力との親和性を高めるフィルターとして機能し、術者の体質を一時的に最適化することで**特定属性を強化**する。

* **精神の調律（チューニング）**
    術者の脳波や精神エネルギーに微細な影響を与え、集中力を高めたり、外部からの精神干渉を防いだりする。これは**状態異常への耐性**として機能する。

***

#### **指輪：精密操作インターフェース**

指先は人体のなかで最も精密な作業が可能な部位であり、指輪はその機能を魔法行使のために拡張するデバイスである。

* **微細制御と術式習熟**
    指先の微細な動きと術式を連動させ、魔法の軌道修正や効果範囲の調整といった精密操作を可能にする。この精密なフィードバックと操作の繰り返しが、術者の魔法への理解度を深め、結果として**練度上昇率の向上**に繋がる。
    * **装備効果例**: 《知恵のブローチ》は、最大MPを+30し、さらに精神作用を通じて**練度上昇率を+15%**向上させる複合的な効果を持つ。

* **術式のショートカットキーと自律維持**
    単純な術式を登録し、詠唱なしで瞬時に発動させたり、一度発動した持続型魔法を自律的に維持させたりする。これにより、術者は他のより高度な魔法に集中できる。

* **精神状態の安定化**
    術者の精神と魔法を直結させるインターフェースとして、精神状態を安定させ、パニックなどを防ぐ。これもまた**状態異常への耐性**に寄与する。

***

#### **ローブ：身体保護と環境適応シェルター**

身体を覆う装束は、強大なエネルギーを扱う術者自身と、その周囲の環境との間に立つインターフェースの役割を果たす。

* **魔法抵抗と絶縁（アース機能）**
    特殊な繊維が、敵性魔法のエネルギーを熱や光に変換・拡散させたり、地面へと逃したりする。これが基本的な**防御力**となる。

* **反動の吸収（サスペンション機能）**
    強力な魔法を発動した際の反動や衝撃を吸収・分散させ、術者の身体的負担を軽減する。

* **詠唱プロセスの最適化**
    上記の保護機能や、内部環境を最適に保つ恒常性維持機能により、術者は常に最高のコンディションでいられる。これにより、思考や動作の遅延がなくなり、結果として**魔法詠唱時間が短縮**される。また、ローブに織り込まれた術式補助パターンが詠唱の一部を代行することもある。

## 5. 新要素習得システム

### 5.1 習得方法

#### ショップ
- **基本要素**: 各フロアのショップで購入可能
- **通貨**: 敵ドロップの魔石
- **品揃え**: フロアが深いほど高級な要素が出現

#### レアドロップ
- **特殊属性**: 光、闇、雷などの稀少属性
- **上級形状**: 追尾、分裂、貫通などの高度な形状
- **特殊効果**: 時間停止、テレポート等のユニーク効果

### 5.2 発見システム
- **宝箱**: 各部屋に配置、新要素や装備品を含む
- **ボス撃破**: フロアボス撃破で確定で新要素獲得
- **隠し部屋**: 特殊な方法で発見、レア要素の宝庫

## 6. UI/UX設計

### 6.1 メイン画面構成
- **中央**: ゲームフィールド
- **右下**: クイックスロット（8個）
- **左上**: HP/MPバー
- **右上**: フロア情報、所持魔石

### 6.2 魔法作成UI
- **左パネル**: 習得済み要素一覧（カテゴリ別タブ）
- **中央**: 組み合わせエリア（ドラッグ&ドロップ）
- **右パネル**: プレビュー、ステータス表示
- **下部**: 保存、テスト、キャンセルボタン

### 6.3 魔法管理UI
- **グリッド表示**: 作成済み魔法をアイコンで表示
- **詳細パネル**: 選択した魔法の詳細情報
- **フィルタ機能**: 属性、効果別で絞り込み
- **お気に入り**: よく使う魔法をマーク

## 7. 技術仕様

### 7.1 開発環境
- **エンジン**: Unity 2022.3 LTS
- **言語**: C#
- **アート**: 2Dスプライト
- **UI**: Unity UI Toolkit

### 7.2 主要システム実装

#### ダンジョン生成
```csharp
public class DungeonGenerator
{
    - GenerateFloor(int floorLevel)
    - CreateRooms(int roomCount)
    - ConnectRooms()
    - PlaceEnemies(int floorLevel)
}
```

#### 魔法システム
```csharp
public class MagicSpell
{
    - List<Element> elements
    - Shape shape
    - List<Effect> effects
    - int proficiency
    - CalculateDamage()
    - CalculateManaCost()
}
```

#### 魔法作成UI
```csharp
public class SpellCraftingUI
{
    - DragAndDropHandler()
    - PreviewSpell()
    - SaveSpell()
    - ValidateSpell()
}
```

## 8. 実装優先順位

### フェーズ1（MVP）
1. 基本的なプレイヤー移動
2. シンプルなダンジョン生成
3. 基本的な魔法システム（1属性、1形状、1効果）
4. 簡単な敵AI
5. 基本UI

### フェーズ2（コア機能）
1. 魔法作成UI実装
2. 練度システム
3. 装備システム
4. レベルアップシステム
5. セーブ/ロード

### フェーズ3（拡張機能）
1. 多様な魔法要素追加
2. ショップシステム
3. 特殊効果・アニメーション
4. バランス調整
5. 音響・BGM

## 9. バランス設計

### 9.1 魔法威力バランス
- 単純な魔法: 低コスト、基本威力
- 複雑な魔法: 高コスト、高威力
- 練度による威力上昇で長期成長

### 9.2 敵強化曲線
```
敵HP = 基本HP × (1.2 ^ フロア数)
敵攻撃力 = 基本攻撃力 × (1.15 ^ フロア数)
```

### 9.3 経験値・報酬バランス
- 同種敵経験値: 初回100% → 50% → 25% → 10%（下限）
- フロアクリア報酬: 固定ボーナス + フロア数ボーナス

## 10. 成功指標

### 技術的成功指標
- 安定した60FPS動作
- ダンジョン生成時間 < 3秒
- UI応答性 < 0.1秒
- メモリ使用量 < 1GB

### ゲームプレイ指標
- プレイヤーが作成する魔法の多様性
- 平均プレイ時間の向上
- フロア到達数の分布
- 魔法作成システムの使用頻度

この設計書により、実装しやすく拡張性の高い魔法創造ダンジョン探索ゲームが開発できます。